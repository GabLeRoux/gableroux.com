---
draft: true
layout: post
title: "Build and test unity3d projects in gitlab-ci"
date: 2018-05-13 19:00:00
categories: unity3d
tags: 
    - unity 
    - docker 
    - ci 
    - gitlab-ci
featured_image: /images/run-unity3d-tests-with-gitlab-ci-and-docker.jpg
---

I code video games in my spare time at [Totema Studio](https://totemastudio.com/) and I wish game developers had more accessible tools for building and testing in the cloud. Imagine a game-jam where each commit gets built every time!

<!-- more -->

I started using CI more and more lately for all my projects and building projects in the cloud is very handy. A few months ago, I started the two following public projects on Gitlab:

* [gitlab.com/gableroux/unity3d](https://gitlab.com/gableroux/unity3d)
* [gitlab.com/gableroux/unity3d-gitlab-ci-example](https://gitlab.com/gableroux/unity3d-gitlab-ci-example)

I was able to create a Docker image with Unity3d installed inside, ready to run commands in some projects, but I quickly [hit a wall with activating Unity3d inside docker](). Unity does not provide an easy way to activate its free license via command line (yet), but thanks to some awesome contributors, we found a workaround! 

## How to build Unity3d projects in the cloud

This is probably what you're looking for. Before we begin, make sure you have some basic knowledge about Docker, Continuous Integration with gitlab-ci and Unity3d. I recommend reading the Getting Started guides and a few tutorials for the technologies I'll cover here.

* [Getting started with docker](https://docs.docker.com/get-started/)
* [Getting started with gitlab-ci](https://docs.gitlab.com/ce/ci/quick_start/README.html)
* [Unity3d tutorials](https://unity3d.com/learn/tutorials)

### Create a Unity3d project the right way

If you don't have a repository and a Unity project yet, follow these steps:

1. Create a repository at [gitlab.com](https://gitlab.com)
2. Clone the repository you just created on your computer
3. Make sure you use the right [.gitignore](https://github.com/github/gitignore/blob/master/Unity.gitignore), download it and place that file at the root of your project. You don't want to track the files generated by Unity that are different for everyone.
4. Create the Unity project using your locally installed Unity3d inside your local repository
5. Commit and push from here

Now we're ready to get started.

### Setup the Unity3d build script

### Setup `.gitlab-ci.yml`

### Try the CI

## Limitations

## Detailed explanation

### The build script

### The `.gitlab-ci.yml` steps

## Other CI support

> What if I'd like to build using [Travis][travis], [CircleCI][circleci] or [Jenkins][jenkins]?

For Travis and CircleCI, I started working on a [github.com/gableroux/]. _I hosted on github because these CI don't support gitlab as of today._ There's this [this guy] who made something similar []() running natively in a MacOS machine on Travis.

Note: Unity activation may be less painful on MacOS when using command line due to a bug on Unity's side. It is said that we don't need to activate when running in `-batchmode` on MacOS.

### Where can I say thanks?

If this helped you, please consider contributing to [gitlab.com/gableroux/unity3d](https://gitlab.com/gableroux/unity3d). You can also [help Totema Studio on Patreon](https://patreon.com/totemastudio/), you'll get early access to our awesome local multilayer games. ‚ù§

---

If you have suggestions, feel free to poke me or [open an issue](https://github.com/GabLeRoux/gableroux.github.io/issues).

[saglacio]: http://saglac.io
[totemastudio]: https://totemastudio.com
